C51 COMPILER V9.60.7.0   RSA                                                               12/22/2025 22:31:04 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE RSA
OBJECT MODULE PLACED IN .\Objects\RSA.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE RSA.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\RSA.l
                    -st) TABS(2) OBJECT(.\Objects\RSA.obj)

line level    source

   1          // RSA.c
   2          #include "RSA.h"
   3          #include "math.h" 
   4          
   5          /**
   6           * Generate RSA key using provided e_val
   7           * Returns TRUE if successful, FALSE if GCD(e, phi) != 1
   8           */
   9          uint8_t rsa_generate_key(uint8_t p, uint8_t q, uint16_t e_val, RSA_Key *key) {
  10   1          uint16_t n, phi, d;
  11   1      
  12   1          n = (uint16_t)p * (uint16_t)q;
  13   1          phi = (uint16_t)(p - 1) * (uint16_t)(q - 1);
  14   1      
  15   1          // Validation: e must be coprime to phi and e > 1
  16   1          if (e_val <= 1 || gcd(e_val, phi) != 1) {
  17   2              return FALSE; 
  18   2          }
  19   1      
  20   1          // Calculate private exponent
  21   1          d = mod_inverse(e_val, phi);
  22   1      
  23   1          key->n = n;
  24   1          key->e = e_val;
  25   1          key->d = d;
  26   1      
  27   1          return TRUE; 
  28   1      }
  29          
  30          void rsa_encrypt(uint16_t plaintext, uint16_t *ciphertext, RSA_Key *key) {
  31   1          *ciphertext = mod_exp(plaintext, key->e, key->n);
  32   1      }
  33          
  34          void rsa_decrypt(uint16_t ciphertext, uint16_t *plaintext, RSA_Key *key) {
  35   1          *plaintext = mod_exp(ciphertext, key->d, key->n);
  36   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    214    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      27
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
